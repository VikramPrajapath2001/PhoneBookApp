<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Phone Book App</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        display: flex;
        height: 100vh;
        flex-direction: column;
      }
      #header {
        background-color: #4caf50;
        color: white;
        padding: 15px;
        text-align: center;
        font-size: 1.5em;
      }
      #sidebar {
        width: 200px;
        background-color: #f0f0f0;
        padding: 20px;
        box-sizing: border-box;
        flex-shrink: 0;
      }
      #content {
        flex-grow: 1;
        padding: 20px;
        overflow-y: auto;
      }
      .btn {
        display: block;
        width: 100%;
        padding: 10px;
        margin-bottom: 10px;
        background-color: #4caf50;
        color: white;
        border: none;
        cursor: pointer;
        text-align: center;
        font-size: 1em;
      }
      .btn:hover {
        background-color: #45a049;
      }
      .contact-card {
        display: flex;
        align-items: center;
        border: 1px solid #ddd;
        margin-bottom: 10px;
        padding: 10px;
        background-color: #fff;
        border-radius: 5px;
      }
      .contact-card img {
        width: 80px;
        height: 80px;
        object-fit: cover;
        margin-right: 15px;
        border-radius: 50%;
      }
      .contact-card h3 {
        margin: 0;
        font-size: 1.2em;
      }
      .contact-card p {
        margin: 5px 0;
        color: #555;
      }
      #contactForm {
        max-width: 500px;
        margin: 0 auto;
      }
      #contactForm input,
      #contactForm select,
      #contactForm button {
        width: 100%;
        padding: 10px;
        margin-bottom: 10px;
        font-size: 1em;
        border: 1px solid #ddd;
        border-radius: 5px;
      }
      #contactForm button {
        background-color: #4caf50;
        color: white;
        cursor: pointer;
      }
      #contactForm button:hover {
        background-color: #45a049;
      }
      .error {
        color: red;
        font-size: 0.8em;
      }

      /* Responsive design */
      @media (max-width: 768px) {
        body {
          flex-direction: column;
        }
        #sidebar {
          width: 100%;
          height: auto;
          box-sizing: border-box;
          order: 1;
        }
        #content {
          margin-top: 20px;
        }
      }
    </style>
  </head>

  <body>
    <div id="header">Phone Book App</div>
    <div style="display: flex; flex: 1;">
      <div id="sidebar">
        <button class="btn" onclick="showView('home')">Home</button>
        <button class="btn" onclick="showView('list')">Contact List</button>
        <button class="btn" onclick="showView('add')">Add New Contact</button>
      </div>
      <div id="content">
        <!-- Dynamic content will be loaded here -->
      </div>
    </div>

    <script>
      let contacts = JSON.parse(localStorage.getItem("contacts")) || [];
      let editingContactId = null;

      function showView(view) {
        const content = document.getElementById("content");
        switch (view) {
          case "home":
            content.innerHTML = `
              <h1>Phone Book Application</h1>
              <p>Welcome to your contact management system</p>
            `;
            break;
          case "list":
            renderContactList();
            break;
          case "add":
            renderContactForm();
            break;
        }
      }

      function renderContactList() {
        const content = document.getElementById("content");
        content.innerHTML = `
          <h2>Contact List</h2>
          ${contacts
            .map(
              (contact) => `
              <div class="contact-card">
                <img src="images/${contact.avatar}"
                     onerror="this.src='/default-avatar.png'"
                     alt="${contact.firstname} ${contact.lastname}">
                <div>
                  <h3>${contact.firstname} ${contact.lastname}</h3>
                  <p>${contact.country}</p>
                  <button onclick="editContact(${contact.id})">Edit</button>
                  <button onclick="deleteContact(${contact.id})">Delete</button>
                </div>
              </div>
            `
            )
            .join("") || "<p>No contacts found</p>"}
        `;
      }

      function renderContactForm(contact = {}) {
        const content = document.getElementById("content");
        editingContactId = contact.id;
        content.innerHTML = `
          <h2>${contact.id ? "Edit Contact" : "Add New Contact"}</h2>
          <form id="contactForm" onsubmit="saveContact(event)">

            <input type="text" name="firstname" placeholder="First Name"
                   value="${contact.firstname || ""}" required>
            <input type="text" name="lastname" placeholder="Last Name"
                   value="${contact.lastname || ""}" required>
            <select name="gender" required>
              <option value="">Select Gender</option>
              <option value="Male" ${contact.gender === "Male" ? "selected" : ""}>Male</option>
              <option value="Female" ${contact.gender === "Female" ? "selected" : ""}>Female</option>
              <option value="Other" ${contact.gender === "Other" ? "selected" : ""}>Other</option>
            </select>
            <input type="date" name="dob" value="${contact.dob || ""}" required>
            <input type="email" name="email" placeholder="Email"
                   value="${contact.email || ""}" required>
            <input type="tel" name="phone" placeholder="Phone" min=10
                   value="${contact.phone || ""}" required>
            <input type="text" name="city" placeholder="City"
                   value="${contact.city || ""}" required>
            <input type="text" name="state" placeholder="State"
                   value="${contact.state || ""}" required>
            <input type="text" name="country" placeholder="Country"
                   value="${contact.country || ""}" required>
            <button type="submit">${contact.id ? "Update" : "Add"} Contact</button>
          </form>
        `;
      }

      function saveContact(event) {
        event.preventDefault();
        const form = event.target;
        const formData = new FormData(form);
        const contact = Object.fromEntries(formData.entries());

        if (editingContactId) {
          const index = contacts.findIndex((c) => c.id === editingContactId);
          contact.id = editingContactId;
          contacts[index] = contact;
        } else {
          contact.id = contacts.length ? Math.max(...contacts.map((c) => c.id)) + 1 : 1;
          contacts.push(contact);
        }

        localStorage.setItem("contacts", JSON.stringify(contacts));
        showView("list");
      }

      function editContact(id) {
        const contact = contacts.find((c) => c.id === id);
        renderContactForm(contact);
      }

      function deleteContact(id) {
        contacts = contacts.filter((contact) => contact.id !== id);
        localStorage.setItem("contacts", JSON.stringify(contacts));
        renderContactList();
      }

      // Initial view
      showView("home");
    </script>
  </body>
</html>
